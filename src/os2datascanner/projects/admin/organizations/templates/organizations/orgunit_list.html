{% extends 'organizations/base.html' %}
{% load i18n %}
{% load mptt_tags %}

{% block title %}{% trans "organizational hierarchy"|capfirst %}{% endblock %}

{% block content %}
{% if orgunit_list.exists %}
<div class="orgunit-list">

    <h2>{% trans "organizational hierarchy for"|capfirst %} {{ organization }}</h2>
    <form name="orgunit_filters"
          class="orgunit_filtering_wrapper"
          onsubmit="return false"
          hx-get="{% url "orgunit-list" organization.slug %}"
          hx-trigger="change"
          hx-swap="outerHTML"
          hx-select=".root"
          hx-target=".root"
            >
        <div class="orgunit_input_wrapper search_field_wrapper">
            <input type="search" 
                    name="search_field" 
                    id="search_field" 
                    placeholder="{% trans "Search for organizational unit" %}" 
                    value="{{ request.GET.search_field }}"/>
        </div>
        <div class="orgunit_input_wrapper">
            <input type="checkbox"
                name="show_empty"
                id="show_empty"
                value="on"/>
            <label for="show_empty">{% trans "Show empty units" %}</label>
        </div>
    </form>
    <ul class="root">
        {% recursetree orgunit_list %}
            <li class="orgunit-list-element {% if not node.is_leaf_node and children %}has_children{% endif %}">
                <span class="orgunit_name">{{ node.name }}</span>
                <span class="orgunit_members">({{ node.members }} {% trans "accounts associated." %})</span>
                {% if not node.is_leaf_node and children %}
                    <ul class="children" hidden>
                        {{ children }}
                    </ul>
                {% endif %}
            </li>
        {% endrecursetree %}
    </ul>
</div>
{% else %}
<span class="root orgunit-list">{% trans "No organizational units."%}</span>
{% endif %}
{% endblock %}
