{% load i18n %}
{% load l10n %}

<form id="filter_form" name='filter_form'
      hx-target=".content" hx-get="{% url "index" %}" hx-swap="innerHTML" 
      hx-trigger="click from:.order-by delay:100ms, change" 
      hx-include="[id='dropdown_options']"
>
  <input type="hidden" name="order_by" id="order_by" value="{{ order_by }}">
  <input type="hidden" name="order" id="order" value="{{ order }}">

  <div class="match_filtering_wrapper">
      <div>
          <button type="button" class="match_filtering_clear_button" name="clear_scannerjob"
                  hx-trigger="click"
                  hx-get="{% url "index" %}"
                  hx-swap="innerHTML"
                  hx-target=".content"
                  hx-include="[id='filter_form'], [id='dropdown_options']"
                  hx-params="not scannerjob"
          >
            {% trans "Clear" %}
          </button>
          <label for="scannerjobs" class="match_filtering_label">
            {% trans "Scan" %}
          </label>
      </div>
      <div class="match_filtering dropdown">
          <select name="scannerjob" id="scannerjobs" autocomplete="off"
          >
            <option value="all"
                    {% if scannerjobs|last == "all" %}
                        selected="selected"
                    {% endif %} >
                    {% trans "All scannerjobs" %}
            </option>
              {% for scan in scannerjobs|first %}
                  <option value="{{ scan.scanner_job_pk|unlocalize }}"
                          {% if request.GET.scannerjob == scan.scanner_job_pk|stringformat:"i" %}
                            selected="selected"
                          {% endif %} >
                      {{ scan.scanner_job_name }} ({{ scan.total }})
                  </option>
               {% endfor %}
          </select>
      </div>
  </div>

  <div class="match_filtering_wrapper">
      <div>
          <button type="button" class="match_filtering_clear_button" name="clear_sensitivities"
          hx-trigger="click"
          hx-get="{% url "index" %}"
          hx-swap="innerHTML"
          hx-target=".content"
          hx-include="[id='filter_form'], [id='dropdown_options']"
          hx-params="not sensitivities"
  >
            {% trans "Clear" %}
          </button>
          <label for="sensitivities" class="match_filtering_label">
            {% trans "Sensitivity" %}
          </label>
      </div>
      <div class="match_filtering dropdown">
          <select name="sensitivities" id="sensitivities" autocomplete="off"
          >
            <option value="all"
                    {% if sensitivities|last == "all" %}
                        selected="selected"
                    {% endif %} >
              {% trans "All sensitivities" %}
            </option>
              {% for sensitivity in sensitivities|first %}
                  <option value="{{ sensitivity.0.value|stringformat:"i" }}"
                        {% if sensitivities|last == sensitivity.0.value|stringformat:"i" %}
                            selected="selected"
                        {% endif %} >
                        {{ sensitivity.0.presentation }}
                        ({{ sensitivity.1 }})
                  </option>
               {% endfor %}
          </select>
      </div>
  </div>

  <div class="checkbox_wrapper">
    <div class="checkbox-group">
      <div class="ds-checkbox">
        {% comment %}
          We use the hidden input field below to track whether 30-days is enabled or not.
          If we used the checkbox, unticking it would make it disappear from the form's GET action
        {% endcomment %}
        <input type="hidden" id="30-days" name="30-days" value="{{ 30_days }}">
        <input type="checkbox" id="30-days-toggle" class="30-days-toggle" {% if 30_days == "true" %}checked{% endif %}>
        <label for="30-days-toggle">
          {% trans "Include results, that are less than 30 days old" %}
        </label>
      </div>
    </div>
  </div>
</form>
