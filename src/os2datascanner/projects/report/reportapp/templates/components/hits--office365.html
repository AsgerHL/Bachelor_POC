{% load handle_extras %}

{% for rule in match.matches.matches %} {% if rule.matches %}
<tr tabindex="0" data-type="office365">

  <td class="datatable__column--filetype-icon">
    <span class="icon-filetype icon-filetype--office365">
      {% include "components/svg-icons/icon-office365.svg" %}
    </span>
  </td>

  <td class="datatable__column--item">
    <span class="scan__item-title">
      <strong>{{ match.matches.handle|present }}</strong>
    </span>

    <span class="scan__item-count">Matches: <em>{{ rule.matches|length }}</em></span>

    <div class="scan__item-meta">
      <span class="">{{ match.matches.handle|find_parent:"ews"|present }}</span>
    </div>

    <div class="hit-link">
      <div class="button-group">
        {% if match.matches.handle|present_url %}
        <a href="{{ match.matches.handle|present_url }}" class="button" target="_blank" rel="noopener">Ã…ben email</a>
        {% endif %}
      </div>
    </div>
  </td>

  <td class="datatable__column--match datatable__column--context" colspan="4">

    <table class="datatable datatable--nested">
      <tbody>
        {% for match in rule.matches|slice:":3" %}
          <tr>
            <td class="datatable__column--match">
                <span class="more">
                    {{ match.match }}
                </span>
            </td>
            <td class="datatable__column--context">
                {% if match.context %}
                    [...]{{ match.context }}[...]
                {% endif %}
            </td>
            <td class="datatable__column--probability">
                {% include "components/probability.html" %}
            </td>
            <td class="datatable__column--handle">
                {% include "components/handle-match.html" %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </td>

</tr>
{% endif %} {% endfor %}
